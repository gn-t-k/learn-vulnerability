# WEBサービスの代表的な脆弱性を理解する

## XSS

ユーザーからの入力を無害化する処理を適切に行わないまま、その入力をもとに他のユーザーに提供するWebページを出力するソフトウェアには、この脆弱性が含まれることがある。

### XSSの仕組み

XSSの脆弱性は、以下のような手順で発生する。

1. 攻撃者によって、フォームなどからデータが入力される
2. Webアプリケーションが、入力されたデータをもとにWebページを動的に生成する
3. 入力されたデータには悪意あるスクリプトが含まれているが、Webアプリケーションはこれを排除しない
4. 一般ユーザーが、生成されたページにアクセスする
5. 攻撃車によって仕組まれた悪意あるスクリプトが、一般ユーザーのブラウザで実行される

### XSSの発生し得る被害

- 正規のページに見せかけた不正なページにユーザーを誘導し、意図しない商品の購入等を行わせる
- 偽のログインページにユーザーを誘導し、IDやパスワードを抜き取る
- 偽の情報入力ページにユーザーを誘導し、個人情報やクレジットカード等の重要な情報を抜き取る
- Cookieを勝手に設定して、セッションを乗っとる
- Cookieを盗み、セッションを乗っ取る

### XSSの対処法

ユーザーの入力をもとに動的にWebページを出力する場合、スクリプトなどは無効化するようにする。

## コマンドインジェクション

Webアプリケーションのプログラム内に、shellなどのコマンドを文字列で組み立てて実行している実装がある場合、そこにデータに紛れさせたコマンド文字列を外部から送り込まれると、コンピュータを不正に操られてしまう問題。

### コマンドインジェクションの仕組み

1. 攻撃者によって、フォームなどからデータが入力される
2. Webアプリケーション内で入力値とともにコマンドの文字列が組み立てられる
3. コマンドの文字列がWebサーバーのshellにおいて解釈・実行される
4. 攻撃者の悪意によって、想定していないコマンドが実行される

### コマンドインジェクションの発生し得る被害

- Webサーバー内に保管してある情報が漏洩する
- Webアプリケーション内の情報が改ざんされる
- Webサーバーを破壊される

### コマンドインジェクションの対処法

shellなどのコマンドを文字列で組み立てて実行するような処理を実装しない。どうしても必要な場合は、`;`や`&&`などの文字を無効化するようにする。

## SQLインジェクション

### SQLインジェクションの仕組み

### SQLインジェクションの発生し得る被害

### SQLインジェクションの対処法

## CSRF

### CSRFの仕組み

### CSRFの発生し得る被害

### CSRFの対処法
